function css(a){var b="",c=document.styleSheets;for(var d in c){var e=c[d].rules||c[d].cssRules;for(var f in e)if("undefined"!=typeof e[f].selectorText){var g=document.querySelectorAll(e[f].selectorText);if(l=g.length,l>0)for(var h=0;l>h;h++)if(g[h].isSameNode(a)){var b=/{(.*)}/,i=e[f].cssText.match(b);if(null!=i){var j=a.getAttribute("style");null!==j?j+=i[0].replace(b,"$1").trim():j=i[0].replace(b,"$1").trim(),a.setAttribute("style",j)}}}}return b}var newbody,body,l;window.onload=function(){body=document.getElementsByTagName("body")[0].getElementsByTagName("*");var a=document.createElement("div");a.style.backgroundColor="rgba(0,0,0,0.6)",a.style.position="absolute",a.style.top="0px",a.style.left="0px",a.style.width="100%",a.style.height=window.innerHeight+"px",a.style.zIndex="9998",a.setAttribute("id","emailcssbookmarklet");var b=document.createElement("div");b.style.backgroundColor="#ffffff",b.style.padding="3px 5px",b.style.zIndex="9998",b.style.position="absolute",b.style.top="0px",b.style.left=window.innerWidth/2-20+"px",b.innerHTML="Please Wait",a.appendChild(b),body[0].appendChild(a),setTimeout(function(){l=body.length;for(var a=l;a--;)css(body[a]);document.getElementsByTagName("link").remove(),document.getElementsByTagName("script").remove(),document.getElementsByTagName("style").remove(),document.getElementsByTagName("link").remove(),document.getElementById("emailcssbookmarklet").remove(),newbody=document.getElementsByTagName("html")[0].innerHTML,newbody=newbody.replace(/\t/g," "),newbody=newbody.replace(/\r/g," "),newbody=newbody.replace(/\n/g," "),newbody=newbody.replace(/\s+/g," ");var b=document.createElement("textarea");b.setAttribute("onclick","this.focus();this.select()"),b.setAttribute("readonly","readonly"),b.style.zIndex="9999",b.style.position="absolute",b.style.top="0px",b.style.left="0px",b.style.width="1000px",b.style.height="1000px",b.innerHTML="<html>"+newbody+"</html>",body[0].appendChild(b)},1e3)},Element.prototype.remove=function(){this.parentElement.removeChild(this)},NodeList.prototype.remove=HTMLCollection.prototype.remove=function(){for(var a=this.length-1;a>=0;a--)this[a]&&this[a].parentElement&&this[a].parentElement.removeChild(this[a])};